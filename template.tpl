___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "LianaAutomation",
  "categories": [
    "MARKETING"
  ],
  "brand": {
    "id": "brand_dummy",
    "displayName": "Liana Technologies",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "description": "This template is used to track user actions on your website and send the data to LianaAutomation.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "url",
    "displayName": "URL",
    "simpleValueType": true,
    "help": "It can be found from channel\u0027s setting page in Automation installation.",
    "valueValidators": [
      {
        "type": "NON_EMPTY",
        "errorMessage": "URL cannot be empty"
      },
      {
        "type": "REGEX",
        "args": [
          "^https://.*"
        ],
        "errorMessage": "The URL must start with \"https://\".",
        "enablingConditions": []
      }
    ]
  },
  {
    "type": "TEXT",
    "name": "verb",
    "displayName": "Verb",
    "simpleValueType": true,
    "valueValidators": [
      {
        "type": "NON_EMPTY",
        "errorMessage": "Verb cannot be empty"
      }
    ],
    "defaultValue": "pbr",
    "help": "Name for event."
  },
  {
    "type": "SIMPLE_TABLE",
    "name": "fields",
    "displayName": "Fields",
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": "Property name",
        "name": "key",
        "type": "TEXT",
        "valueValidators": [
          {
            "type": "NON_EMPTY",
            "errorMessage": "Property name cannot be empty"
          }
        ],
        "isUnique": true
      },
      {
        "defaultValue": "",
        "displayName": "Property value",
        "name": "value",
        "type": "TEXT",
        "selectItems": [],
        "macrosInSelect": false,
        "valueValidators": []
      }
    ],
    "help": "Properties for event.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ]
  },
  {
    "type": "CHECKBOX",
    "name": "debug",
    "checkboxText": "Debug",
    "simpleValueType": true,
    "help": "Log debug messages to console. Useful to enable for diagnostic purposes."
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

//Include required APIs from sandboxed Javascript
const getCookieValues = require('getCookieValues');
const setCookie = require('setCookie');
const injectScript = require('injectScript');
const logToConsole = require('logToConsole');
const queryPermission = require('queryPermission');
const copyFromWindow = require('copyFromWindow');
const getUrl = require('getUrl');
//Functions
const getCookieValue = () => {
  let cookie = getCookieValues('liana_t');
  if (! cookie[0]) {
    return '';
  }
  return cookie[0];
};

const setCookieValue = (value, expires) => {
  log('Set liana cookie.', value);
  let currentProtocol = getUrl('protocol');
  let secure = true;
  let samesite = 'None';
  if (currentProtocol !== 'https') {
    secure = false;
    samesite = 'Lax';
  }
  let cookieSettings = {
    path: '/',
    secure: secure,
    samesite: samesite,
    expires: expires
  };
  log('Cookie settings.', cookieSettings);
  setCookie('liana_t', value, cookieSettings);
};

//This gets called after successfully injecting gtm.js script
const scriptInjectionSucceeded = () => {
    //Stop requests from https://gtm-msr.appspot.com/render2 and tagmanager.googleusercontent.com
    if (getUrl('host').search('gtm-msr.appspot') != -1 || (! data.is_gtm_editor &&                    getUrl('host').search('tagmanager.googleusercontent') != -1)) {
      log('Stopped execution for URL', getUrl('host'));
      return false;
    }
	//Call data.gtmOnSuccess when the tag is finished successfully.
	log('Script loaded successfully.');

  	const automationObject = copyFromWindow('Automation');
  	log('Automation Object', automationObject);
	if (! automationObject) {
		log('Invalid data returned from injected object');
		data.gtmOnFailure();
		return;
	}
    let cookieValue = automationObject.getTrackingCode();
	if (! cookieValue || cookieValue === 'cookie_value') {
		log('Cookie was not set in injected script.');
		data.gtmOnFailure();
        return;
	}
  	setCookieValue(cookieValue, automationObject.getExpireDateForCookie());
	let eventFields = {};
	data.fields.forEach(function (currentObject) {
		log(currentObject.key, currentObject.value);
		eventFields[currentObject.key] = currentObject.value;
	});
	log('eventFields.', eventFields);

    automationObject.sendEvent(data.url, data.verb, eventFields, function() {
		//Automation request done
		//loadend event handled here, we assume request was successful
		log('sendEvent executed.');
		data.gtmOnSuccess();
	});

};

//If injection of script fails this gets called
const scriptInjectionFailed = () => {
	log('Script load failed.');
	data.gtmOnFailure();
};

//Execution

//Output to console, if debug is checked
const log = data.debug ? logToConsole : (() => {});

//Stop requests from https://gtm-msr.appspot.com/render2 and tagmanager.googleusercontent.com
if (getUrl('host').search('gtm-msr.appspot') != -1 || (! data.is_gtm_editor && getUrl('host').search('tagmanager.googleusercontent') != -1)) {
  log('Stopped execution for URL', getUrl('host'));
  return false;
}

//Validation
log('data', data);

if (! data.url) {
  log('Invalid URL', data.url);
  data.gtmOnFailure();
  return;
}

if (! queryPermission('inject_script', data.url)) {
  log('Missing permission for URL', data.url);
  data.gtmOnFailure();
  return;
}

if (! data.verb) {
  log('Invalid Verb', data.verb);
  data.gtmOnFailure();
  return;
}

if (! data.fields) {
  log('Invalid Fields', data.fields);
  data.gtmOnFailure();
  return;
}

if (data.fields.length === 0) {
  log('Empty Fields', data.fields);
  data.gtmOnFailure();
  return;
}

var keysInFields = [];
for (var i = 0; i < data.fields.length; i++) {
  if (! data.fields[i].key || ! data.fields[i].hasOwnProperty('value')) {
     log('Invalid data in Fields', data.fields);
     data.gtmOnFailure();
     return;
  }

  if (keysInFields.indexOf(data.fields[i].key) >= 0) {
     log('duplicate key found in Fields', data.fields);
     data.gtmOnFailure();
     return;
  }

  keysInFields.push(data.fields[i].key);
}

//Inject gtm.js script
log('liana_t for injection', getCookieValues('liana_t'));
let injectURL = data.url + '?liana_t=' + getCookieValue();
injectScript(injectURL, scriptInjectionSucceeded, scriptInjectionFailed);


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Automation"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "cookieAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "cookieNames",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "liana_t"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://*.lianacem.com/t/*/gtm*"
              },
              {
                "type": 1,
                "string": "https://*.cem.127.0.0.1.nip.io/t/*/gtm*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "set_cookies",
        "versionId": "1"
      },
      "param": [
        {
          "key": "allowedCookies",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "name"
                  },
                  {
                    "type": 1,
                    "string": "domain"
                  },
                  {
                    "type": 1,
                    "string": "path"
                  },
                  {
                    "type": 1,
                    "string": "secure"
                  },
                  {
                    "type": 1,
                    "string": "session"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "liana_t"
                  },
                  {
                    "type": 1,
                    "string": "*"
                  },
                  {
                    "type": 1,
                    "string": "/"
                  },
                  {
                    "type": 1,
                    "string": "any"
                  },
                  {
                    "type": 1,
                    "string": "non_session"
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "get_url",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urlParts",
          "value": {
            "type": 1,
            "string": "specific"
          }
        },
        {
          "key": "protocol",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "host",
          "value": {
            "type": 8,
            "boolean": true
          }
        },
        {
          "key": "queriesAllowed",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios:
- name: Spamming from bot
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    mock('getUrl', function(component) {
      if (component == 'host') {
        return 'gtm-msr.appspot.com';
      }
    });


    const result = runCode(mockData);

    assertThat(result).isFalse();
    assertApi('gtmOnFailure').wasNotCalled();
    assertApi('gtmOnSuccess').wasNotCalled();
- name: Invalid URL given
  code: |-
    const mockData = {
      url: 'abcd',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(1);

    mockData.url = 'https://www.random.com/';
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(2);

    mockData.url = null;
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(3);
    assertApi('gtmOnSuccess').wasNotCalled();
- name: Missing query permission for given URL
  code: |-
    const setCookie = require('setCookie');

    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/random/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(1);

    mockData.url = 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/js';
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(2);

    mockData.url = 'https://t.cem.127.0.0.1.nip.io/';
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(3);

    mockData.url = 'https://t.127.0.0.1.nip.io/t/asd38dh8jd9/gtm';
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(4);
    assertApi('gtmOnSuccess').wasNotCalled();
- name: Invalid Verb given
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: null,
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(1);

    mockData.verb = '';
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(2);
    assertApi('gtmOnSuccess').wasNotCalled();
- name: Invalid Fields given
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [],
      debug: false,
      is_gtm_editor: true
    };

    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(1);

    mockData.fields = null;
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(2);

    mockData.fields = [
    {key : 'email', value : 'test@email.com'},
    {propkey : 'key', provalue : 'value'}];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(3);

    mockData.fields = [
    {key : 'email', value : 'test@email.com'},
    {key : 'key', provalue : 'value'}];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(4);

    mockData.fields = [
    {key : 'email', value : 'test@email.com'},
    {key : 'key', valuea : 'value'}];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(5);

    mockData.fields = [
    {key : 'email', value : 'test@email.com'},
    {key : null, value : 'value'}];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(6);

    mockData.fields = [
    {key : 'email', value : 'test@email.com'},
    {key : '', value : 'value' }];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(7);

    mockData.fields = [
    {key : 'email', value : 'test@email.com'},
    {key : 'key1', value : 'value1' },
    {key : 'key1', value : 'value2'}];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(8);

    mockData.fields = [
    {key : 'email', value : ''},
    { key : 'key1', value : 'value2'}
    ];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(9);
    mockData.fields = [
    {key : 'email', value : null},
    { key : 'key1', value : 'value2'}
    ];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(10);
    mockData.fields = [
    { key : 'key1', value : 'value2'}
    ];
    runCode(mockData);
    assertApi('gtmOnFailure').wasCalled(11);
    assertApi('gtmOnSuccess').wasNotCalled();
- name: Cookie for injection
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL with cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=abcd');
    });
    mock('getCookieValues', ['abcd']);
    runCode(mockData);
    assertApi('injectScript').wasCalled();

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL with first value found for cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=abcd1');
    });
    mock('getCookieValues', ['abcd1', 'abcd2']);
    runCode(mockData);
    assertApi('injectScript').wasCalled();

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL with empty cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=');
    });
    mock('getCookieValues', ['']);
    runCode(mockData);
    assertApi('injectScript').wasCalled();

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL without finding cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=');
    });
    mock('getCookieValues', []);
    runCode(mockData);
    assertApi('injectScript').wasCalled();
- name: Script injection failed
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL with first value found for cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=abcd');
       onFailure();
    });
    mock('getCookieValues', ['abcd']);
    runCode(mockData);
    assertApi('injectScript').wasCalled();
    assertApi('gtmOnFailure').wasCalled();
- name: Invalid data returned from injected script
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      is_gtm_editor: true
    };

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL with first value found for cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=abcd');
       onSuccess();
    });
    mock('getCookieValues', ['abcd']);
    mock('copyFromWindow', null);
    runCode(mockData);
    assertApi('injectScript').wasCalled(1);
    assertApi('getCookieValues').wasCalled(2);
    assertApi('setCookie').wasNotCalled();
    assertApi('gtmOnSuccess').wasNotCalled();
    assertApi('copyFromWindow').wasCalled(1);
    assertApi('gtmOnFailure').wasCalled(1);
- name: Set cookie value with value from injected script
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL with first value found for cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=abcd');
       onSuccess();
    });
    mock('getCookieValues', ['abcd']);
    mock('setCookie', (name, value, options) => {
      if (name !== 'liana_t') fail('setCookie called with incorrect cookie name');
      if (value !== 'a1b2c3') fail('setCookie not called with same value as retrieved from Automation.getTrackingCode');
      //if (options.domain !== 'auto') fail('setCookie called with different domain name');
      if (options.secure !== true) fail('setCookie called without having set secure to true');
      if (options.samesite !== 'None') fail('setCookie called with different samesite');
      if (options.expires !== 'Sat, 1 Jun 2030 00:00:00 GMT') fail('setCookie not called with returned expire date from Automation.getExpireDateForCookie');
    });
    mock('copyFromWindow', Automation);
    runCode(mockData);
    assertApi('injectScript').wasCalled(1);
    assertApi('getCookieValues').wasCalled(2);
    assertApi('setCookie').wasCalled(1);
    assertApi('gtmOnSuccess').wasCalled(1);
    assertApi('gtmOnFailure').wasNotCalled();
- name: Setting cookie failed due to invalid value
  code: |-
    const mockData = {
      url: 'https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm',
      verb: 'pbr',
      fields: [
        { key : 'email', value : 'test@email.com'}
      ],
      debug: false,
      is_gtm_editor: true
    };

    mock('injectScript', function(url, onSuccess, onFailure) {
       assertThat(url, 'URL with first value found for cookie').isEqualTo('https://t.cem.127.0.0.1.nip.io/t/asd38dh8jd9/gtm?liana_t=');
       onSuccess();
    });
    mock('getCookieValues', ['']);
    Automation.getTrackingCode = function() {
      return 'cookie_value';
    };
    mock('copyFromWindow', Automation);
    runCode(mockData);
    assertApi('injectScript').wasCalled(1);
    assertApi('getCookieValues').wasCalled(2);
    assertApi('setCookie').wasNotCalled();
    assertApi('gtmOnSuccess').wasNotCalled();
    assertApi('gtmOnFailure').wasCalled();
setup: "var Automation = {};\n\nAutomation.sendEvent = function(url, verb, fields,\
  \ handler) {\n   handler();\n};\n\nAutomation.getTrackingCode = function() {\n \
  \ return 'a1b2c3';\n};\n\nAutomation.getExpireDateForCookie = function() {\n   return\
  \ 'Sat, 1 Jun 2030 00:00:00 GMT'; \n};"


___NOTES___

Created on 2/24/2021, 4:05:19 PM


